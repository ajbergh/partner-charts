--- charts-original/charts/prometheus/templates/server/sts.yaml
+++ charts/charts/prometheus/templates/server/sts.yaml
@@ -78,6 +78,7 @@
               readOnly: {{ .readOnly }}
           {{- end }}
         {{- end }}
+
         - name: {{ template "prometheus.name" . }}-{{ .Values.server.name }}
           image: "{{ include "get.serverimage" .}}"
           imagePullPolicy: "{{ .Values.server.image.pullPolicy }}"
@@ -86,6 +87,9 @@
 {{ toYaml .Values.server.env | indent 12}}
           {{- end }}
           args:
+          {{- if .Values.server.prefixURL }}
+            - --web.route-prefix={{ .Values.server.prefixURL }}
+          {{- end }}
           {{- if .Values.server.retention }}
             - --storage.tsdb.retention.time={{ .Values.server.retention }}
           {{- end }}
@@ -158,12 +162,25 @@
     {{- if .Values.server.sidecarContainers }}
       {{- range $name, $spec :=  .Values.server.sidecarContainers }}
         - name: {{ $name }}
-          {{- toYaml $spec | nindent 10 }}
+          {{- if kindIs "string" $spec }}
+            {{- tpl $spec $ | nindent 10 }}
+          {{- else }}
+            {{- toYaml $spec | nindent 10 }}
+          {{- end }}
       {{- end }}
     {{- end }}
-    {{- if .Values.global.imagePullSecret }}
+      hostNetwork: {{ .Values.server.hostNetwork }}
+    {{- if .Values.server.dnsPolicy }}
+      dnsPolicy: {{ .Values.server.dnsPolicy }}
+    {{- end }}
+    {{- if (or .Values.global.imagePullSecret .Values.imagePullSecrets) }}
       imagePullSecrets:
+      {{- if .Values.global.imagePullSecrets }}
         - name: {{ .Values.global.imagePullSecret }}
+      {{- end }}
+      {{- if .Values.imagePullSecrets }}
+{{ toYaml .Values.imagePullSecrets | indent 8 }}
+      {{- end }}
     {{- end }}
     {{- if .Values.server.nodeSelector }}
       nodeSelector:
@@ -173,6 +190,10 @@
       hostAliases:
 {{ toYaml .Values.server.hostAliases | indent 8 }}
     {{- end }}
+    {{- if .Values.server.dnsConfig }}
+      dnsConfig:
+{{ toYaml .Values.server.dnsConfig | indent 8 }}
+    {{- end }}
     {{- if .Values.server.securityContext }}
       securityContext:
 {{ toYaml .Values.server.securityContext | indent 8 }}
@@ -209,11 +230,17 @@
         - name: {{ .name }}
           secret:
             secretName: {{ .secretName }}
+            {{- with .optional }}
+            optional: {{ . }}
+            {{- end }}
       {{- end }}
       {{- range .Values.configmapReload.prometheus.extraConfigmapMounts }}
         - name: {{ .name }}
           configMap:
             name: {{ .configMap }}
+            {{- with .optional }}
+            optional: {{ . }}
+            {{- end }}
       {{- end }}
 {{- if .Values.server.extraVolumes }}
 {{ toYaml .Values.server.extraVolumes | indent 8}}
